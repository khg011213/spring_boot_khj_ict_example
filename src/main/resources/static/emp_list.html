<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

<script src="/eshopper/js/emp.js"></script>

<script type="text/javascript">
$(document).ready(function(){

	function listCallback(result) {	
	
		let htmls="";
		
		$("#list-table").html('');
		
	
		$("<tr>" , {
			html : "<td>" + "직원번호" + "</td>"+  // 컬럼명들
					"<td>" + "이름" + "</td>"+
					"<td>" + "직업" + "</td>"+
					"<td>" + "관리인" + "</td>"+				
					"<td>" + "고용일" + "</td>"+
					"<td>" + "급여" + "</td>"+				
					"<td>" + "커미션" + "</td>"+
					"<td>" + "부서번호" + "</td>"
		}).appendTo("#list-table") // 이것을 테이블에 붙임
		
		if(result.length <1){
			htmls.push("사원이 없습니다.");
		}else{
			
			$(result).each(function(){
				htmls += '<tr>';
				htmls += '<td>'+ this.empno + '</td>'; 
				htmls += '<td>'+ this.ename + '</td>';
				htmls += '<td>'+ this.job + '</td>'; 
				htmls += '<td>'+ this.mgr + '</td>';
				htmls += '<td>'+ this.hiredate + '</td>'; 
				htmls += '<td>'+ this.sal + '</td>';
				htmls += '<td>'+ this.comm + '</td>'; 
				htmls += '<td>'+ this.deptno + '</td>';
	            htmls += '<td>'+ '<input id=' + this.empno + " type='button' class='btn_delete' value='삭제'>" + '</td>';
	            htmls += '</tr>';			
				
			}); //each end			
			htmls+='<tr>';
	    	htmls+='<td colspan="5"> <a href="/write_view.html">글작성</a> </td>';		                	
	    	htmls+='</tr>';
		}
		
		$('#list-table').append(htmls);
	
   }
   
	let emp = empService();
	emp.list(listCallback);
   
	
	
});
</script>

<!-- arrt은 호출한놈에 들어있는 놈 -->
<script type="text/javascript">
$(document).ready(function(){
	$(document).on("click","#list-table .btn_delete", function(){
		console.log($(this).attr("id"));
		
		$(this).parent().parent().remove(); // html을 삭제 시켜줘서 버튼을 누르면 html은 사라짐 하지만 db는 그대로
		
		let emp = empService();
		
		emp.del($(this).attr("id")); //ajax를 이용해서 db데이터를 삭제시킴
	});

 
});

</script>


</head>
<body>
	<h1>Restful 게시판 연습</h1>

	<table id="list-table" width="500" cellpadding="0" cellspacing="0"
		border="1">

	</table>


</body>
</html>